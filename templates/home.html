{% extends 'base.html' %}
{% load static %}

{% block title %}Home - School Search{% endblock %}

{% block content %}
<div class="home-container">
    <!-- Header with Greeting and Search Bar -->
    <div class="home-header">
        <h1 class="greeting-text">
            {% now "H" as current_hour %}
            {% with hour=current_hour|add:"0" %}
                {% if hour < 12 %}
                    Good Morning
                {% elif hour < 18 %}
                    Good Afternoon
                {% else %}
                    Good Evening
                {% endif %}
            {% endwith %}
        </h1>
        <div class="home-search-bar" onclick="window.location.href='{% url 'school_search' %}'">
            <span class="material-icons">search</span>
            <span>Search for schools...</span>
        </div>
    </div>

    <!-- Curricula Carousel -->
    <div class="carousel-section">
        <div class="carousel-section-header">
            <h2 class="carousel-title">Curricula</h2>
        </div>
        <div class="carousel-section-content">
            <div class="carousel-container">
                <div class="swiper" id="curricula-carousel">
                    <div class="swiper-wrapper">
                        {% for curriculum in curricula %}
                        <div class="swiper-slide">
                            <a href="{% url 'curriculum_detail' curriculum.id %}" class="carousel-item curriculum-item">
                                <div class="carousel-item-content">
                                    {% if curriculum.abbreviation %}
                                    <div class="curriculum-abbr">{{ curriculum.abbreviation }}</div>
                                    {% endif %}
                                    <h3 class="carousel-item-title">{{ curriculum.name }}</h3>
                                    {% if curriculum.description %}
                                    <p class="carousel-item-desc">{{ curriculum.description|truncatewords:15 }}</p>
                                    {% endif %}
                                </div>
                            </a>
                        </div>
                        {% empty %}
                        <div class="empty-state-small">No curricula available</div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="carousel-section-pagination">
                <div class="swiper-pagination" id="curricula-pagination"></div>
            </div>
        </div>
    </div>

    <!-- Schools Carousel -->
    <div class="carousel-section">
        <div class="carousel-section-header">
            <h2></h2>
            <h2></h2>
            <h2 class="carousel-title">Recommended Schools</h2>
        </div>
        <div class="carousel-section-content">
            <div class="carousel-container">
                <div class="swiper" id="schools-carousel">
                    <div class="swiper-wrapper">
                        {% for school in recommended_schools %}
                        <div class="swiper-slide">
                            <a href="{% url 'school_detail' school.id %}" class="carousel-item school-item">
                                {% if school.image %}
                                <img src="{{ school.image.url }}" alt="{{ school.name }}" class="carousel-item-image">
                                {% else %}
                                <div class="carousel-item-image-placeholder">
                                    <span class="material-icons">school</span>
                                </div>
                                {% endif %}
                                <div class="carousel-item-content">
                                    <h3 class="carousel-item-title">{{ school.name }}</h3>
                                    <p class="carousel-item-subtitle">
                                        <span class="material-icons" style="font-size: 14px;">location_on</span>
                                        {{ school.location }}
                                    </p>
                                    <div class="carousel-item-meta">
                                        <span class="rating-badge-small">
                                            <span class="material-icons" style="font-size: 14px;">star</span>
                                            {{ school.rating }}
                                        </span>
                                        <span style="font-weight: 600;">â‚¹{% if school.default_fee %}{{ school.default_fee }}{% else %}N/A{% endif %}</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% empty %}
                        <div class="empty-state-small">No schools available</div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="carousel-section-pagination">
                <div class="swiper-pagination" id="schools-pagination"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Curricula Carousel
    const curriculaSwiper = new Swiper('#curricula-carousel', {
        slidesPerView: 'auto',
        spaceBetween: 24,
        loop: true,
        freeMode: true,
        grabCursor: true,
        centeredSlides: false,
        pagination: {
            el: '#curricula-pagination',
            clickable: true,
            renderBullet: function (index, className) {
                return '<span class="' + className + ' carousel-dot"></span>';
            },
        },
        breakpoints: {
            320: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            480: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            768: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            1024: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
        },
    });
    
    // Initialize Schools Carousel
    const schoolsSwiper = new Swiper('#schools-carousel', {
        slidesPerView: 'auto',
        spaceBetween: 24,
        loop: true,
        freeMode: true,
        grabCursor: true,
        centeredSlides: false,
        pagination: {
            el: '#schools-pagination',
            clickable: true,
            renderBullet: function (index, className) {
                return '<span class="' + className + ' carousel-dot"></span>';
            },
        },
        breakpoints: {
            320: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            480: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            768: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
            1024: {
                slidesPerView: 'auto',
                spaceBetween: 24,
            },
        },
    });
});
</script>
{% endblock %}
